#include <stdio.h>
#include <stdlib.h>
 
#include "graph.h"
#include "pageRank.h"

void sort_and_print(Graph* g){
	
	int i,j,tmp;
	double tmpValue;
	int* id;
	double* value;
	
	id=(int*)malloc(g->nbPages * sizeof(int));
	value=(double*)malloc(g->nbPages * sizeof(double));
	
	for(i=0;i<g->nbPages;i++){
		id[i] = i;
		value[i] = g->value[i];
	}
	
	//Tri décroissant à bubulles
	for(i=0;i<g->nbPages-1;i++){
		for(j=0;j<g->nbPages-i-1;j++){
		
			if(value[j] < value[j+1]){
			
				tmp = id[j];
				tmpValue = value[j];
				
				id[j] = id[j+1];
				value[j] = value[j+1];
				
				id[j+1] = tmp;
				value[j+1] = tmpValue;
			
			}
		}
	}

    FILE* file = NULL;
	file = fopen("Result_Sorted.txt", "w+");
	
	if (file==NULL){
		fprintf(stderr, "Erreur : Probleme à l'ouverture du fichier.\n");
		exit(EXIT_FAILURE);
    }
	
	//Pour toutes les pages
	for(i=0;i<g->nbPages;i++){
		
		//On écrit l'identifiant de la page et la chance de se trouver sur cette dernière
		fprintf(file,"%d \t %.15f\n",id[i],value[i]);
	}
	fclose(file);
	
	printf("Fichier Result_Sorted.txt mis à jour.\n");
	
	
    free(id);
    free(value);
}

